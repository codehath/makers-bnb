{% extends "base.html" %}

<h1>Approval Page</h1>

{% block content %}
<article>
    <article>
        {% for booking in booking_dict}
        <p>Booking Name: {{ booking.name }}</p>
        <p>Start Date: {{ booking.start_date }}</p>
        <p>End Date: {{ booking.end_date }}</p>
        <p>Approved: {{ booking.approved }}</p>
        {% endfor %}
    
        <!-- Access space details directly -->
        {% for space in space dict %}
        <p>Space ID: {{ space.id }}</p>
        <p>Space Name: {{ space.name }}</p>
        <p>Space Description: {{ space.description }}</p>
        {% endfor %}
        <!-- Add other details as needed -->
    </article>
    <p>other space not confirmed</p>
</article>
<form action="/confirm" method="post">
    <button id="confirm-button" type="submit">Confirm this booking</button>
</form>
<form id="rejectForm" method="post">
    <input type="hidden" name="booking_id" value="">
    <button id="reject-button" type="submit">Reject this booking</button>
</form>

<script>
    // Get the number from the current URL
    const currentURL = window.location.href;
    const matchResult = currentURL.match(/\/(\d+)$/); // Matches the last digits in the URL
    const bookingNumber = matchResult ? matchResult[1] : null;

    // Set the value of the hidden input based on the number from the URL
    if (bookingNumber !== null) {
        document.getElementById('booking_id').value = bookingNumber;
    }

    // Set the form action dynamically
    const form = document.getElementById('rejectForm');
    form.action = '/reject/' + bookingNumber; // Replace '/reject/' with your actual endpoint
</script>
</body>
{% endblock %}